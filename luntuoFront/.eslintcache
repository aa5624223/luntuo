[{"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\index.js":"1","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\App.js":"2","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\memoryUtils.js":"3","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\storageUtils.js":"4","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Login\\index.jsx":"5","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Admin\\index.jsx":"6","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\index.js":"7","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\api\\index.js":"8","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Deskop\\index.jsx":"9","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Matrial\\index.jsx":"10","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\AdminOptLog\\index.jsx":"11","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\MRP\\index.jsx":"12","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report1\\index.jsx":"13","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\OptRecord\\index.jsx":"14","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\AdminUserConfig\\index.jsx":"15","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service1\\index.jsx":"16","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report3\\index.jsx":"17","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report2\\index.jsx":"18","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\ExcelUp\\index.jsx":"19","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report4\\index.jsx":"20","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service4\\index.jsx":"21","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service3\\index.jsx":"22","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service2\\index.jsx":"23","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\left-nav\\index.jsx":"24","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\header\\index.jsx":"25","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\StaticSet.js":"26","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\api\\ajax.js":"27","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\config\\form-Fields.js":"28","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\config\\left-menu-list.js":"29","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\config\\table-columns.js":"30","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\link-button\\index.jsx":"31","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\AdvancedSearchForm\\index.jsx":"32","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\anaData\\index.js":"33","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder\\index.jsx":"34","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrderExcel\\index.jsx":"35","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrderDet\\index.jsx":"36","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_CgInfo\\index.jsx":"37","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_JjInfo\\index.jsx":"38","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_BjInfo\\index.jsx":"39","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_BjInfo2\\index.jsx":"40"},{"size":498,"mtime":1616814274150,"results":"41","hashOfConfig":"42"},{"size":587,"mtime":1616807147835,"results":"43","hashOfConfig":"42"},{"size":105,"mtime":1615258349880,"results":"44","hashOfConfig":"42"},{"size":598,"mtime":1615259872910,"results":"45","hashOfConfig":"42"},{"size":4502,"mtime":1616810258024,"results":"46","hashOfConfig":"42"},{"size":5940,"mtime":1619512672895,"results":"47","hashOfConfig":"42"},{"size":9223,"mtime":1619575690779,"results":"48","hashOfConfig":"42"},{"size":9534,"mtime":1619398559564,"results":"49","hashOfConfig":"42"},{"size":4714,"mtime":1616398720994,"results":"50","hashOfConfig":"42"},{"size":11466,"mtime":1616915415406,"results":"51","hashOfConfig":"42"},{"size":246,"mtime":1615265222012,"results":"52","hashOfConfig":"42"},{"size":10717,"mtime":1616739732747,"results":"53","hashOfConfig":"42"},{"size":4700,"mtime":1616401626520,"results":"54","hashOfConfig":"42"},{"size":4923,"mtime":1616913610914,"results":"55","hashOfConfig":"42"},{"size":17277,"mtime":1616913474733,"results":"56","hashOfConfig":"42"},{"size":5729,"mtime":1616561290522,"results":"57","hashOfConfig":"42"},{"size":4156,"mtime":1617601715928,"results":"58","hashOfConfig":"42"},{"size":4170,"mtime":1619573597503,"results":"59","hashOfConfig":"42"},{"size":15573,"mtime":1619250167350,"results":"60","hashOfConfig":"42"},{"size":4298,"mtime":1618469761558,"results":"61","hashOfConfig":"42"},{"size":9652,"mtime":1619153574351,"results":"62","hashOfConfig":"42"},{"size":8009,"mtime":1619153534376,"results":"63","hashOfConfig":"42"},{"size":14171,"mtime":1616913537905,"results":"64","hashOfConfig":"42"},{"size":6385,"mtime":1616810301727,"results":"65","hashOfConfig":"42"},{"size":2970,"mtime":1617781610656,"results":"66","hashOfConfig":"42"},{"size":227,"mtime":1616561007617,"results":"67","hashOfConfig":"42"},{"size":789,"mtime":1616390277634,"results":"68","hashOfConfig":"42"},{"size":16510,"mtime":1617601410857,"results":"69","hashOfConfig":"42"},{"size":5548,"mtime":1615967125736,"results":"70","hashOfConfig":"42"},{"size":43034,"mtime":1619576315625,"results":"71","hashOfConfig":"42"},{"size":216,"mtime":1615258349843,"results":"72","hashOfConfig":"42"},{"size":3151,"mtime":1616220281414,"results":"73","hashOfConfig":"42"},{"size":10434,"mtime":1617677888483,"results":"74","hashOfConfig":"42"},{"size":23877,"mtime":1619512687471,"results":"75","hashOfConfig":"42"},{"size":10424,"mtime":1619511340009,"results":"76","hashOfConfig":"42"},{"size":6740,"mtime":1619140726406,"results":"77","hashOfConfig":"42"},{"size":17762,"mtime":1619252656846,"results":"78","hashOfConfig":"42"},{"size":14516,"mtime":1619252541214,"results":"79","hashOfConfig":"42"},{"size":15692,"mtime":1618619439632,"results":"80","hashOfConfig":"42"},{"size":19006,"mtime":1619576675804,"results":"81","hashOfConfig":"42"},{"filePath":"82","messages":"83","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},"1vygspr",{"filePath":"85","messages":"86","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"87","messages":"88","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"89","messages":"90","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"91","messages":"92","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"93","messages":"94","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"95","messages":"96","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"97"},{"filePath":"98","messages":"99","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"100","messages":"101","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"102"},{"filePath":"103","messages":"104","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"105","messages":"106","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"107","messages":"108","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"109","messages":"110","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"111","messages":"112","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"113","messages":"114","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"117","messages":"118","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"119","messages":"120","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"121","messages":"122","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"123","messages":"124","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"125","messages":"126","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"127","messages":"128","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"129","messages":"130","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"131","messages":"132","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"133","messages":"134","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"135","messages":"136","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"139","messages":"140","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"141","messages":"142","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"143","messages":"144","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"145","messages":"146","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"147","messages":"148","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"149","messages":"150","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"151","messages":"152","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"153","messages":"154","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"155","messages":"156","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"157","messages":"158","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"159","usedDeprecatedRules":"84"},{"filePath":"160","messages":"161","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"162","messages":"163","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"84"},{"filePath":"164","messages":"165","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"166"},"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\index.js",[],["167","168"],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\App.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\memoryUtils.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\storageUtils.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Login\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Admin\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\index.js",["169"],"import XLSX from 'xlsx';\r\nimport {Button,Space,Input,Select,Form} from 'antd'\r\nimport FileSaver from \"file-saver\";\r\n\r\nimport { SearchOutlined } from '@ant-design/icons';\r\nimport Highlighter from 'react-highlight-words';\r\n\r\nimport moment from \"moment\"\r\nimport { getSite_Roles_Opt } from \"../api\"\r\nimport localStore from \"./storageUtils\"\r\nimport {SERVER_ADDRESS_FILEPATH,SERVER_ADDRESS_DEMOPATH} from './StaticSet'\r\n/*\r\n    常用的方法集合\r\n*/\r\n//遍历侧边栏树\r\nexport const depTree = (Roles, parentId) => {\r\n    const items = [];\r\n    let flg = true;//是否结束递归\r\n    for (let i = 0; i < Roles.length; i++) {\r\n        if (Roles[i].parentId * 1 === parentId) {\r\n            if (Roles[i].UrlKey !== undefined) {\r\n                items.push(createMenuObj(Roles[i]));\r\n            } else {\r\n                items.push(Roles[i]);\r\n            }\r\n            flg = false;\r\n        }\r\n    }\r\n    if (flg) {\r\n        return [];\r\n    } else {\r\n        for (let i = 0; i < items.length; i++) {\r\n            items[i].children = depTree(Roles, items[i].id);\r\n        }\r\n        return items;\r\n    }\r\n}\r\n//排序侧边栏树\r\nexport const OrderTree = (items) => {\r\n    for (let i = 0; i < items.length; i++) {\r\n        for (let j = 0; j < items.length; j++) {\r\n            if (items[i].cOrder < items[j].cOrder) {\r\n                let temp = items[i];\r\n                items[i] = items[j];\r\n                items[j] = temp;\r\n            }\r\n        }\r\n    }\r\n    for (let i = 0; i < items.length; i++) {\r\n        if (items[i].children.length !== 0) {\r\n            items[i].children = OrderTree(items[i].children);\r\n        }\r\n    }\r\n    return items;\r\n}\r\nexport const createMenuObj = (obj) => {\r\n    let rtObj = {};\r\n    rtObj.id = obj.ID * 1;\r\n    rtObj.title = obj.title;\r\n    rtObj.key = obj.UrlKey;\r\n    rtObj.isOpt = obj.isOpt === \"True\";\r\n    rtObj.cOrder = obj.cOrder * 1;\r\n    rtObj.isMenu = obj.isMenu === \"True\"\r\n    rtObj.parentId = obj.parentId * 1;\r\n    rtObj.children = [];\r\n    rtObj.isAuth = obj.isAuth === \"True\";\r\n    rtObj.isSubMenu = obj.isSubMenu === \"True\";\r\n    return rtObj;\r\n}\r\n//查找用户 拥有该页面的哪些权限\r\nexport const getPageRoles = async (mapKey) => {\r\n    var formData = new FormData();\r\n    formData.append(\"mapKey\", mapKey);\r\n    formData.append(\"Roles\", localStore.getUser().Roles);\r\n    let result = await getSite_Roles_Opt(formData);\r\n    if (result.status === 0) {\r\n        return result.data.Site_Roles;\r\n    } else {\r\n        return [];\r\n    }\r\n}\r\n//查找用户 是否拥有操作权限\r\nexport const isOpt = (Arr, title) => {\r\n    const flg = Arr.find(item => {\r\n        if (item.title === title) {\r\n            return true;\r\n        } else {\r\n            return false\r\n        }\r\n    })\r\n    return flg !== undefined;\r\n}\r\n//将Json对象转为formData\r\nexport const ConvertFomrData = (jsons) => {\r\n    let formData1 = new FormData();\r\n    Object.keys(jsons).forEach((key) => {\r\n\r\n        if (typeof (jsons[key]) == \"object\") {\r\n            if (jsons[key] !== null && jsons[key]!==undefined&&jsons[key]!==\"\") {\r\n                //console.dir(jsons[key]);\r\n                formData1.append(key + \"[0]\", jsons[key][0].format('yyyy-MM-DD'));\r\n                formData1.append(key + \"[1]\", jsons[key][1].format('yyyy-MM-DD'));\r\n            }\r\n        } else {\r\n            formData1.append(key, jsons[key]);\r\n        }\r\n\r\n    })\r\n    return formData1;\r\n}\r\n//将json数据转为EXCEL进行下载\r\n//json 原始的数据\r\n//Colums Table的列List\r\nfunction JsonTOexcelData(datas, Colums) {\r\n    //const type = 'xlsx';\r\n    let ExcelDatas = [];    \r\n    datas.forEach(data => {\r\n        let ExcelData = {};\r\n        Colums.forEach(Colum => {\r\n            ExcelData[Colum.title] = data[Colum.key]\r\n        })\r\n        ExcelDatas.push(ExcelData);\r\n    })\r\n    return ExcelDatas;\r\n}\r\n/**\r\n * json 数据\r\n * Colums 标题\r\n * ColumsWch 每列的宽度\r\n * fileName 文件名\r\n */\r\nexport function downloadExcel(json,Header,ColumsWch,fileName){\r\n    console.dir(json);\r\n    json = JsonTOexcelData(json,Header);\r\n    const workbook = XLSX.utils.book_new();\r\n    let ws = XLSX.utils.json_to_sheet(json);\r\n     ws[\"!cols\"]=ColumsWch;\r\n    XLSX.utils.book_append_sheet(workbook, ws, \"sheet1\");//把sheet添加到workbook里，第三个参数是sheet名\r\n    const wopts = { bookType: \"xlsx\", bookSST: false, type: \"array\" };//写入的样式bookType:输出的文件类型，type：输出的数据类型，bookSST: 是否生成Shared String Table，官方解释是，如果开启生成速度会下降，但在低版本IOS设备上有更好的兼容性\r\n    const wbout = XLSX.write(workbook, wopts);\r\n    FileSaver.saveAs(new Blob([wbout], { type: \"application/octet-stream\" }), `${fileName} ${moment().format(\"YYYYMMDDHHmmss\")}.xlsx`);//保存文件\r\n\r\n}\r\n\r\nexport function downloadUpFile(fileName){\r\n    window.open (SERVER_ADDRESS_FILEPATH+fileName)\r\n}\r\nexport function downloadDemoFile(fileName){\r\n    window.open (SERVER_ADDRESS_DEMOPATH+fileName)\r\n}\r\nexport const getColumnSearchProps = (dataIndex,_this)=>({\r\n    filterDropdown:({setSelectedKeys,selectedKeys,confirm,clearFilters })=>(\r\n        <div style={{padding:8}}>\r\n            <Input\r\n            ref={node => {\r\n                _this.searchInput = node;\r\n            }}\r\n            placeholder={`输入查询条件`}\r\n            value = {selectedKeys[0]}\r\n            onChange={e => setSelectedKeys(e.target.value ? [e.target.value] : [])}\r\n            onPressEnter={() => _this.handleSearch(selectedKeys, confirm, dataIndex)}\r\n            style={{ width: 188, marginBottom: 8, display: 'block' }}\r\n            />\r\n            <Space>\r\n                <Button\r\n                type=\"primary\"\r\n                onClick={() => _this.handleSearch(selectedKeys, confirm, dataIndex)}\r\n                icon={<SearchOutlined />}\r\n                size=\"small\"\r\n                style={{ width: 90 }}\r\n                >查询</Button>\r\n                <Button\r\n                onClick={() => _this.handleReset(clearFilters)}\r\n                size=\"small\"\r\n                style={{ width: 90 }}\r\n                >重置</Button>\r\n            </Space>\r\n        </div>\r\n    ),\r\n    filterIcon:filtered =><SearchOutlined style={{ color: filtered ? '#1890ff' : undefined }} />,\r\n    \r\n    onFilterDropdownVisibleChange:visible =>{\r\n        if (visible) {\r\n            setTimeout(() => _this.searchInput.select(), 100);\r\n          }\r\n    },\r\n    render:text=>\r\n        _this.state.searchedColumn === dataIndex ?(\r\n            <Highlighter\r\n      highlightStyle={{ backgroundColor: '#ffc069', padding: 0 }}\r\n      searchWords={[_this.state.searchText]}\r\n      autoEscape\r\n      textToHighlight={text ? text.toString() : ''}\r\n    />\r\n    ):(\r\n        text\r\n    )\r\n})\r\n//带选择框的\r\nexport const getColumnSearchPropsSelect = (dataIndex,_this,key)=>({\r\n    filterDropdown:({setSelectedKeys,selectedKeys,confirm,clearFilters })=>(\r\n        <div style={{padding:8}}>\r\n            <Form layout=\"inline\">\r\n                <Form.Item\r\n                    label=\"物料层级\"\r\n                    \r\n                >\r\n                    <select \r\n                        ref={node=>{\r\n                            _this[key] = node;\r\n                        }}\r\n                    >\r\n                        <option value=\"1\">一</option>\r\n                        <option value=\"2\">二</option>\r\n                        <option value=\"3\">三</option>\r\n                        <option value=\"4\">四</option>\r\n                        <option value=\"5\">五</option>\r\n                    </select>\r\n                </Form.Item>\r\n            </Form>\r\n            <Input\r\n            ref={node => {\r\n                _this.searchInput = node;\r\n            }}\r\n            placeholder={`输入查询条件`}\r\n            value = {selectedKeys[0]}\r\n            onChange={e => setSelectedKeys(e.target.value ? [e.target.value] : [])}\r\n            onPressEnter={() => _this.handleSearch(selectedKeys, confirm, dataIndex)}\r\n            style={{ width: 188, marginBottom: 8, display: 'block' }}\r\n            />\r\n            <Space>\r\n                <Button\r\n                type=\"primary\"\r\n                onClick={() => _this.handleSearch(selectedKeys, confirm, dataIndex)}\r\n                icon={<SearchOutlined />}\r\n                size=\"small\"\r\n                style={{ width: 90 }}\r\n                >查询</Button>\r\n                <Button\r\n                onClick={() => _this.handleReset(clearFilters)}\r\n                size=\"small\"\r\n                style={{ width: 90 }}\r\n                >重置</Button>\r\n            </Space>\r\n        </div>\r\n    ),\r\n    filterIcon:filtered =><SearchOutlined style={{ color: filtered ? '#1890ff' : undefined }} />,\r\n    \r\n    onFilterDropdownVisibleChange:visible =>{\r\n        if (visible) {\r\n            setTimeout(() => _this.searchInput.select(), 100);\r\n          }\r\n    },\r\n    render:text=>\r\n        _this.state.searchedColumn === dataIndex ?(\r\n            <Highlighter\r\n      highlightStyle={{ backgroundColor: '#ffc069', padding: 0 }}\r\n      searchWords={[_this.state.searchText]}\r\n      autoEscape\r\n      textToHighlight={text ? text.toString() : ''}\r\n    />\r\n    ):(\r\n        text\r\n    )\r\n})","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\api\\index.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Deskop\\index.jsx",[],["170","171"],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Matrial\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\AdminOptLog\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\MRP\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report1\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\OptRecord\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\AdminUserConfig\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service1\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report3\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report2\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\ExcelUp\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Report4\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service4\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service3\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\Service2\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\left-nav\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\header\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\utils\\StaticSet.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\api\\ajax.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\config\\form-Fields.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\config\\left-menu-list.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\config\\table-columns.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\link-button\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\components\\AdvancedSearchForm\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\anaData\\index.js",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrderExcel\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrderDet\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_CgInfo\\index.jsx",["172"],"import React, { Component } from 'react'\r\n//导入组件\r\nimport { Button, Input, Form, DatePicker, Table, message, Spin, Checkbox } from 'antd'\r\n//导入方法\r\nimport moment from 'moment'\r\n//自定义组件\r\nimport LinkButton from '../../components/link-button';\r\n//引入less\r\nimport './index.less'\r\n//本地化\r\nimport 'moment/locale/zh-cn';\r\nimport locale from 'antd/es/date-picker/locale/zh_CN';\r\n//自定义方法\r\nimport { ConvertFomrData } from '../../utils'\r\n//导入api\r\nimport { getV_Sum_Num_CgInfo } from '../../api'\r\n//Excel\r\nimport XLSX from 'xlsx'\r\n//导入配置\r\nimport { DdOrder_CgInfo_columns} from '../../config/table-columns'\r\nimport { ArrowLeftOutlined } from '@ant-design/icons';\r\n//引入缓存\r\nimport store from 'store'\r\nconst { RangePicker } = DatePicker;\r\n//表格扩展\r\nconst expandedRowRender = (record, index) => {\r\n    //DdOrder_Det_Sum_columns\r\n    //console.dir(record);\r\n    const data = record.Det;\r\n    if (data === undefined || data.length === 0) {\r\n        return \"\";\r\n    }\r\n    // var DetVal = [];\r\n    // var newData = {};\r\n    // for (let i = 0; i < data.length; i++) {\r\n    //     if (newData[data[i].Datetime1] === undefined) {\r\n    //         //console.dir(data[i].Datetime1);\r\n    //         newData[data[i].Datetime1] = 0;\r\n    //     }\r\n    // }\r\n    // for (var key in newData) {\r\n    //     for (let i = 0; i < data.length; i++) {\r\n    //         if (key === data[i].Datetime1) {\r\n    //             newData[key] += (data[i].Menge * 1)\r\n    //         }\r\n    //     }\r\n    // }\r\n    //DetVal.push({ ID: 1, ...newData });\r\n    //根据时间创建多个Table\r\n    //moment(dt).isBetween(dt1,dt2);\r\n    var newColums = [];\r\n    var newData = [];\r\n    //是否创建数组\r\n    var dt1 = null;\r\n    var dt2 = null;\r\n    data.forEach((item,index) => {\r\n        let singleColums = [];\r\n        var dt = new Date(item.Datetime1);\r\n        let dt3 = moment(dt);\r\n        dt3.add(1,'m');\r\n        if(newColums.length===0||!moment(dt3).isBetween(dt1,dt2)){\r\n            let singleArr = {};\r\n            dt1 = moment(dt).startOf(\"month\");\r\n            dt2 = moment(dt).endOf(\"month\");\r\n            let dt4 = moment(dt).startOf(\"month\");\r\n            //插入表头的第一列\r\n            singleColums.push({\r\n                title: '日期',\r\n                dataIndex: '日期',\r\n            })\r\n            //插入表头第一列的内容为空\r\n            singleArr[moment(dt1).format('YYYYMM')] = 0;\r\n            singleArr.ID = moment(dt1).format('YYYYMM');\r\n            //插入其他列\r\n            dt4.add(1, 's');\r\n            for(let i=1;i<=31;i++){\r\n                var key = i<10?'0'+i:''+i;\r\n                singleColums.push({\r\n                    title:key,\r\n                    dataIndex:key,\r\n                })\r\n                singleArr[key] = 0;\r\n            }\r\n            singleArr[\"dt\"]=moment(dt3);\r\n            singleArr[\"日期\"]=moment(dt3).format(\"YYYYMM\");\r\n            newColums.push(singleColums);\r\n            newData.push(singleArr);\r\n        }\r\n        \r\n        newColums.forEach((item2,index2)=>{\r\n            let dt5 = moment(newData[index2][\"dt\"]).startOf(\"month\");\r\n            let dt6 = moment(newData[index2][\"dt\"]).endOf(\"month\");\r\n            if(moment(dt3).isBetween(dt5,dt6)){\r\n                newData[index2][moment(dt3).format('DD')] = item.Menge*1;\r\n            }\r\n            //moment(dt3).format('YYYYMM')\r\n            \r\n        })\r\n    })\r\n    // return (<div>\r\n    //     {\r\n    //         newColums.map((_,index)=>{\r\n    //             return(\r\n    //                 <Table\r\n    //                     bordered\r\n    //                     size=\"small\"\r\n    //                     rowKey=\"ID\"\r\n    //                     key={'tab'+index}\r\n    //                     columns={newColums[index]}\r\n    //                     dataSource={newData}\r\n    //                     pagination={false}\r\n    //                 >\r\n    //                 </Table>\r\n    //             )\r\n    //         })\r\n    //     }\r\n    // </div>)\r\n    return <Table\r\n                bordered\r\n                size=\"small\"\r\n                rowKey=\"ID\"\r\n                columns={newColums[0]}\r\n                dataSource={newData}\r\n                pagination={false}\r\n            >\r\n    </Table>\r\n\r\n}\r\n//调度单 采购明细查看\r\nexport default class DdOrder_CgInfo extends Component {\r\n    formRef = React.createRef();\r\n    state = {\r\n        dataSource: [],\r\n        loading: true,\r\n        DIDS: \"\",\r\n        SearchContation: {},\r\n        current: 1,\r\n        dataTotal: 0,\r\n        LTOrders: \"\",\r\n        ExcelLoading: false,\r\n        SpinTip:'',\r\n        model: 0,\r\n        expandRowKeys: []\r\n    }\r\n    TablerepetClassName = (record, index) => {\r\n\r\n        if (record.repeat === true) {\r\n            //console.dir(\"class\");\r\n            return \"Tablerepet\";\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n    ModalExcelOut = async () => {\r\n        var { DIDS, ExcelLoading, LTOrders ,model} = this.state;//当前的订单\r\n        if (ExcelLoading) {\r\n            message.warn(\"数据打包中，请勿重复点击\");\r\n            return;\r\n        }\r\n        const form = this.formRef.current;\r\n        var tempFormData = form.getFieldsValue(true);//当前查询条件\r\n        var ExcelJson = [];\r\n        tempFormData.DIDS = DIDS;\r\n        tempFormData.page = 1;\r\n        tempFormData.pageSize = 99999;\r\n        const FormData = ConvertFomrData(tempFormData);\r\n        //添加loading效果\r\n        this.setState({ ExcelLoading: true ,SpinTip:'Excel数据打包中'});\r\n        const result = await getV_Sum_Num_CgInfo(FormData);\r\n        if (result.status === 0) {\r\n            const jo_V_CgInfo = result.jo_V_CgInfo.V_CgInfo;\r\n            var jo_V_CgInfoSum = result.jo_V_CgInfoSum.V_CgInfo;\r\n            //console.dir(jo_V_CgInfo);\r\n            const colums = DdOrder_CgInfo_columns(model);\r\n            var i = 0;\r\n            for (; i < jo_V_CgInfoSum.length; i++) {\r\n                jo_V_CgInfoSum[i].ID = \"ID\" + i;\r\n                for (var j=0; j < jo_V_CgInfo.length; j++) {\r\n                    if (model === \"1\") {\r\n\r\n                        if (jo_V_CgInfoSum[i].Matnr === jo_V_CgInfo[j].Matnr && jo_V_CgInfoSum[i].Series === jo_V_CgInfo[j].Series) {\r\n                            var dt = new Date(jo_V_CgInfo[j].Datetime1);\r\n                            if (jo_V_CgInfoSum[i][moment(dt).format(\"YYYYMMDD\")] !== undefined) {\r\n                                jo_V_CgInfoSum[i][moment(dt).format(\"YYYYMMDD\")] += jo_V_CgInfo[j].Menge * 1;\r\n                            } else {\r\n                                jo_V_CgInfoSum[i][moment(dt).format(\"YYYYMMDD\")] = jo_V_CgInfo[j].Menge * 1;\r\n                            }\r\n                        }\r\n                    }else{\r\n                        if (jo_V_CgInfoSum[i].Matnr === jo_V_CgInfo[j].Matnr && jo_V_CgInfoSum[i].Lifnr === jo_V_CgInfo[j].Lifnr) {\r\n                            var dt = new Date(jo_V_CgInfo[j].Datetime1);\r\n                            if (jo_V_CgInfoSum[i][moment(dt).format(\"YYYYMMDD\")] !== undefined) {\r\n                                jo_V_CgInfoSum[i][moment(dt).format(\"YYYYMMDD\")] += jo_V_CgInfo[j].Menge * 1;\r\n                            } else {\r\n                                jo_V_CgInfoSum[i][moment(dt).format(\"YYYYMMDD\")] = jo_V_CgInfo[j].Menge * 1;\r\n                            }\r\n                        }\r\n\r\n                    }\r\n\r\n                }\r\n            }\r\n            for (let k = 0; k < jo_V_CgInfoSum.length; k++) {\r\n                let single = {}\r\n\r\n                for (let l = 0; l < colums.length; l++) {\r\n                    single[colums[l].title] = jo_V_CgInfoSum[k][colums[l].dataIndex];\r\n                }\r\n                for (let key2 in jo_V_CgInfoSum[k]) {\r\n                    if (!isNaN(Number(key2))) {\r\n                        single[key2 + \" \"] = jo_V_CgInfoSum[k][key2];\r\n                    }\r\n                }\r\n                ExcelJson.push(single);\r\n            }\r\n\r\n            let book = XLSX.utils.book_new();\r\n            let sheet = XLSX.utils.json_to_sheet(ExcelJson);\r\n            sheet[\"!cols\"] = [\r\n                { wch: 15 }, { wch: 20 }, { wch: 10 }, { wch: 8 }, { wch: 12 }, { wch: 30 }, { wch: 12 }, { wch: 12 }, { wch: 15 }, { wch: 15 }\r\n            ];\r\n            XLSX.utils.book_append_sheet(book, sheet, 'Sheet1')\r\n            XLSX.writeFile(book, `采购需求单 ${LTOrders} ` + moment().format('YYYYMMDD') + '.xlsx')\r\n        } else {\r\n            message.error(\"网络错误\")\r\n        }\r\n        this.setState({ ExcelLoading: false });\r\n\r\n    }\r\n    handleBack = () => {\r\n        const { history } = this.props;\r\n        history.goBack();\r\n    }\r\n    componentDidMount = () => {\r\n        //DIDS 和LTOrdders 必须对应\r\n        var { DIDS, LTOrders } = this.props.location;\r\n        //用于测试后期删掉\r\n        //DIDS = \"76,77,78\";\r\n        //LTOrders = \"LT20210201,LT20210301,LT20210401\";\r\n        if (DIDS === undefined || LTOrders === undefined) {\r\n            DIDS = store.get(\"DdOrder_JjInfo_DIDS\");\r\n            LTOrders = store.get(\"DdOrder_JjInfo_LTOrders\");\r\n        } else {\r\n            store.set(\"DdOrder_JjInfo_DIDS\", DIDS);\r\n            store.set(\"DdOrder_JjInfo_LTOrders\", LTOrders);\r\n        }\r\n        this.setState({ DIDS: DIDS, LTOrders }, () => {\r\n            this.SearchData();\r\n        })\r\n    }\r\n    SearchData = async (pagination = {}) => {\r\n        var { DIDS, SearchContation } = this.state;\r\n        const form = this.formRef.current;\r\n        if (pagination.page === undefined) {\r\n            SearchContation.page = 1;\r\n            SearchContation.pageSize = 100;\r\n        } else {\r\n            SearchContation.page = pagination.page;\r\n            SearchContation.pageSize = pagination.pageSize;\r\n        }\r\n        if (DIDS === \"\" || DIDS === undefined) {\r\n            DIDS = \"0\";\r\n        }\r\n        var tempFormData = form.getFieldsValue(true);\r\n        tempFormData.DIDS = DIDS;\r\n\r\n        if (tempFormData.model !== undefined) {\r\n            let tepModel = tempFormData.model[0];\r\n            delete tempFormData.model;\r\n            tempFormData.model = tepModel;\r\n        }\r\n\r\n        tempFormData.page = SearchContation.page;\r\n        tempFormData.pageSize = SearchContation.pageSize;\r\n\r\n        const FormData = ConvertFomrData(tempFormData);\r\n        this.setState({ loading: true })\r\n        const result = await getV_Sum_Num_CgInfo(FormData);\r\n        if (result.status === 0) {\r\n            const jo_V_CgInfo = result.jo_V_CgInfo.V_CgInfo;\r\n            var jo_V_CgInfoSum = result.jo_V_CgInfoSum.V_CgInfo;\r\n\r\n            var i = 0;\r\n            //var j = 0;\r\n            var preSum = {};\r\n            for (; i < jo_V_CgInfoSum.length; i++) {\r\n                if (i === 0) {\r\n                    preSum = { ...jo_V_CgInfoSum[0] };\r\n                }\r\n                jo_V_CgInfoSum[i].ID = \"D\" + i;\r\n                for (var j = 0; j < jo_V_CgInfo.length; j++) {\r\n                    //console.dir(jo_V_CgInfoSum[i].Matnr);\r\n                    if (tempFormData.model === \"1\") {\r\n                        if (jo_V_CgInfoSum[i].Matnr === jo_V_CgInfo[j].Matnr && jo_V_CgInfoSum[i].Series === jo_V_CgInfo[j].Series) {\r\n                            if (jo_V_CgInfoSum[i].Det === undefined) {\r\n                                jo_V_CgInfoSum[i].Det = [];\r\n                            }\r\n                            jo_V_CgInfoSum[i].Det.push(jo_V_CgInfo[j]);\r\n                        }\r\n                    } else {\r\n                        if (jo_V_CgInfoSum[i].Matnr === jo_V_CgInfo[j].Matnr && jo_V_CgInfoSum[i].Lifnr === jo_V_CgInfo[j].Lifnr) {\r\n                            if (jo_V_CgInfoSum[i].Det === undefined) {\r\n                                jo_V_CgInfoSum[i].Det = [];\r\n                            }\r\n                            jo_V_CgInfoSum[i].Det.push(jo_V_CgInfo[j]);\r\n                        }\r\n\r\n                    }\r\n                }\r\n                if (i !== 0 && preSum.Matnr === jo_V_CgInfoSum[i].Matnr && tempFormData.model !== \"1\") {\r\n                    jo_V_CgInfoSum[i].Det = [];\r\n                    jo_V_CgInfoSum[i].repeat = true;\r\n                } else if (i !== 0 && preSum.Matnr === jo_V_CgInfoSum[i].Matnr && i !== 0 && preSum.Series === jo_V_CgInfoSum[i].Series && tempFormData.model === \"1\") {\r\n                    jo_V_CgInfoSum[i].Det = [];\r\n                    jo_V_CgInfoSum[i].repeat = true;\r\n                }\r\n                else {\r\n                    preSum = jo_V_CgInfoSum[i];\r\n                }\r\n            }\r\n            console.dir(jo_V_CgInfoSum);\r\n            this.setState({ loading: false, dataSource: jo_V_CgInfoSum, current: tempFormData.page, dataTotal: result.jo_V_CgInfoSum.V_CgInfo_Count, model: tempFormData.model })\r\n        } else {\r\n            this.setState({ loading: false });\r\n            message.error(\"网络错误\");\r\n        }\r\n    }\r\n    //打开或关闭所有展开项\r\n    OpenOrCloseAll = () => {\r\n        //expandRowKeys\r\n        const { expandRowKeys, dataSource } = this.state;\r\n        if (expandRowKeys.length > 0) {//关闭\r\n            this.setState({ expandRowKeys: [] });\r\n        } else {//展开\r\n            let newArr = [];\r\n            for (let i = 0; i < dataSource.length; i++) {\r\n                newArr.push(dataSource[i].ID);\r\n            }\r\n            this.setState({ expandRowKeys: newArr });\r\n        }\r\n    }\r\n    OpenOrCloseSingle = (record, type) => {\r\n        let { expandRowKeys } = this.state;\r\n        if (type) {\r\n            expandRowKeys.push(record.ID);\r\n        } else {\r\n            expandRowKeys = expandRowKeys.filter(item => {\r\n                if (item === record.ID) {\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            })\r\n        }\r\n        this.setState({ expandRowKeys });\r\n    }\r\n    render() {\r\n        const { loading, dataSource, LTOrders, current, dataTotal, ExcelLoading, model, expandRowKeys ,SpinTip} = this.state;\r\n        return (\r\n            <div className=\"main\">\r\n                <div className=\"toolArea\">\r\n                    <Form layout=\"inline\" ref={this.formRef} >\r\n                        <Form.Item>\r\n                            <LinkButton onClick={() => this.handleBack()}>\r\n                                <ArrowLeftOutlined />返回调度单\r\n                            </LinkButton>\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            name=\"Datetime1\"\r\n                            label=\"时间\"\r\n                        >\r\n                            <RangePicker locale={locale} />\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            name=\"Series\"\r\n                            label=\"系列\"\r\n                        >\r\n                            <Input />\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            name=\"model\"\r\n                            label=\"区分系列\"\r\n                        >\r\n                            <Checkbox.Group>\r\n                                <Checkbox value=\"1\"></Checkbox>\r\n                            </Checkbox.Group>\r\n                        </Form.Item>\r\n                        <Form.Item>\r\n                            <Button type=\"primary\" onClick={() => this.SearchData()} >查询</Button>\r\n                            &nbsp;&nbsp;\r\n\r\n                        </Form.Item>\r\n                    </Form>\r\n                </div>\r\n                <div>\r\n                    <div style={{ width: \"75%\", float: \"left\" }}>\r\n                        <h1 style={{ fontSize: '20px', paddingLeft: '20px', lineHeight: '35px' }}>\r\n                            <Button onClick={() => this.OpenOrCloseAll()}>展开/关闭所有行</Button>\r\n                            &nbsp;单号:{LTOrders}\r\n                        </h1>\r\n                    </div>\r\n                    <div style={{ width: \"24%\", float: \"left\", textAlign: 'right' }}>\r\n\r\n                        <Button type=\"primary\" onClick={() => this.ModalExcelOut()} >Excel导出</Button>\r\n                    </div>\r\n                </div>\r\n                <Table\r\n                    dataSource={dataSource}\r\n                    bordered\r\n                    rowKey=\"ID\"\r\n                    sticky={true}\r\n                    scroll={{ y: 560 }}\r\n                    size=\"middle\"\r\n                    columns={DdOrder_CgInfo_columns(model)}\r\n                    loading={loading}\r\n                    rowClassName={this.TablerepetClassName}\r\n                    pagination={{\r\n                        position: ['bottomCenter'],\r\n                        pageSizeOptions: [20],\r\n                        current: current,\r\n                        total: dataTotal,\r\n                        showTotal: (total, range) => `一共 ${total} 条数据`,\r\n                        pageSize: 100,\r\n                        onChange: (page, pageSize) => {\r\n                            this.SearchData({ page: page, pageSize: pageSize });\r\n                        }\r\n                    }}\r\n                    expandable={{\r\n                        expandRowByClick: true,\r\n                        expandedRowRender,\r\n                        columnWidth: 8,\r\n                        indentSize: 0,\r\n                        expandedRowKeys: expandRowKeys,\r\n                        onExpand: (expanded, record) => { this.OpenOrCloseSingle(record, expanded) }\r\n                    }}\r\n                >\r\n\r\n                </Table>\r\n                <Spin style={{ position: 'absolute', left: '48%', top: '47%' }} tip={SpinTip} spinning={ExcelLoading}></Spin>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_JjInfo\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_BjInfo\\index.jsx",[],"D:\\WorkSpace\\luntuo\\luntuoFront\\src\\pages\\DdOrder_BjInfo2\\index.jsx",["173","174","175","176"],"import React, { Component } from 'react'\r\n//引入antd\r\nimport { Button, Table,Form,Input,Spin} from 'antd'\r\nimport moment from 'moment'\r\n//自定义组件\r\nimport LinkButton from '../../components/link-button';\r\nimport { ArrowLeftOutlined } from '@ant-design/icons';\r\n//引入api\r\nimport { getV_Sum_Num_BjInfo2,getV_BjInfo } from '../../api'\r\n//引入工具类\r\nimport { ConvertFomrData,downloadExcel } from '../../utils'\r\n//引入配置\r\nimport { DdOrder_BjInfo_First,V_BjInfo_columns} from '../../config/table-columns'\r\n//引入样式\r\nimport './index.less'\r\n//引入缓存\r\nimport store from 'store'\r\nexport default class DdOrder_BjInfo2 extends Component {\r\n    formRef = React.createRef();\r\n    constructor(props) {\r\n        super(props);\r\n        var { DIDS, LTOrders } = this.props.location;\r\n        console.dir(DIDS);\r\n        if (DIDS === undefined || LTOrders === undefined) {\r\n            DIDS = store.get(\"DdOrder_BjInfo_DIDS\");\r\n            LTOrders = store.get(\"DdOrder_BjInfo_LTOrders\");\r\n        } else {\r\n            store.set(\"DdOrder_BjInfo_DIDS\", DIDS);\r\n            store.set(\"DdOrder_BjInfo_LTOrders\", LTOrders);\r\n        }\r\n        this.state = {\r\n            DIDS:DIDS,\r\n            LTOrders:LTOrders,\r\n            dataSource: [],\r\n            loading: true,\r\n            SearchContation: {},\r\n            current: 1,\r\n            dataTotal: 0,\r\n            LTOrders: LTOrders,\r\n            ExcelLoading: false,\r\n            model: 0,\r\n            expandRowKeys: [],\r\n            searchText:'',\r\n            SpinTip:'',\r\n            ExcelLoading:false,\r\n            level:'',\r\n            level2:'',\r\n        }\r\n    }\r\n    handleSearch = (selectedKeys, confirm, dataIndex)=>{\r\n        const {SearchContation} = this.state;\r\n        confirm({ closeDropdown: false })\r\n        var filters = {};\r\n        if(selectedKeys[0]!==undefined){\r\n            filters[dataIndex] = selectedKeys[0];\r\n            this.handleTableChange({},filters,{},0);\r\n        }else{\r\n            SearchContation[dataIndex]=\"\";\r\n            this.handleTableChange({},{},{},0);\r\n        }\r\n    }\r\n    //重置\r\n    handleReset = clearFilters=>{\r\n        clearFilters();\r\n        this.setState({ searchText: '' });\r\n    }\r\n    handleTableChange = async (pagination = {}, filters = {}, sorter = {},model) => {\r\n        let { SearchContation,DIDS } = this.state;\r\n        console.dir(filters);\r\n        if (pagination.current === undefined) {\r\n            SearchContation.page = 1;\r\n            SearchContation.pageSize = 100;\r\n        } else {\r\n            SearchContation.page = pagination.current;\r\n            SearchContation.pageSize = pagination.pageSize;\r\n        }\r\n        //添加条件\r\n        if (filters !== {}) {\r\n            for (let key in filters) {\r\n                SearchContation[key] = filters[key];\r\n            }\r\n        }\r\n        console.dir(this.SearchSelect);\r\n        // 添加层级的条件\r\n        if(this.SearchSelect !==undefined && this.SearchSelect.value!==undefined){\r\n            SearchContation[\"level\"] = this.SearchSelect.value;\r\n        }\r\n        if(this.SearchSelect2 !==undefined && this.SearchSelect2.value!==undefined){\r\n            SearchContation[\"level2\"] = this.SearchSelect2.value;\r\n        }\r\n        //添加表单的条件\r\n        const formReftemp = this.formRef.current;\r\n        var tempFormData = formReftemp.getFieldsValue(true);//当前查询条件\r\n        //创建提交后台数据\r\n        SearchContation.DIDS = DIDS;\r\n        //console.dir(tempFormData.Series);\r\n        // if((tempFormData.Series===\"\" || tempFormData.Series===undefined) && model===1){\r\n        //     message.warn(\"请输入系列，再查询\");\r\n        //     return;\r\n        // }\r\n        if(tempFormData.Series!==\"\" && tempFormData.Series!==undefined){\r\n            SearchContation.model=1;\r\n        }\r\n        SearchContation = {...SearchContation,...tempFormData}\r\n        const formData = ConvertFomrData(SearchContation);\r\n        this.setState({ loading: true });\r\n        const result = await getV_Sum_Num_BjInfo2(formData);\r\n        if (result.status === 0) {\r\n            const { V_BjInfo } = result.data;\r\n            //console.dir(V_BjInfo);\r\n            if (V_BjInfo.length === 0) {\r\n                //console.dir(V_BjInfo.length);\r\n                this.setState({ dataSource: [], current: 1, dataTotal: 0, loading: false });\r\n            } else {\r\n                //console.dir(\"index\");\r\n                //val.replace(/\\b(0+)/gi,\"\")\r\n                V_BjInfo.forEach(item => {\r\n                    item.FirstCode = item.FirstCode.replace(/\\b(0+)/gi, \"\");\r\n                    item.SecondCode = item.SecondCode.replace(/\\b(0+)/gi, \"\");\r\n                    item.ThirdCode = item.ThirdCode.replace(/\\b(0+)/gi, \"\");\r\n                    item.FourthCode = item.FourthCode.replace(/\\b(0+)/gi, \"\");\r\n                    item.FifthCode = item.FifthCode.replace(/\\b(0+)/gi, \"\");\r\n                })\r\n                this.Arr = [];\r\n                this.expandRowKeys2 = [];\r\n                this.deepTree(V_BjInfo, 0, {});\r\n                //console.dir(this.expandRowKeys);\r\n                let tempSource = this.Arr.slice(0,9);\r\n                this.setState({ dataSource: tempSource, current:1,dataTotal:this.Arr.length ,loading: false,expandRowKeys: this.expandRowKeys2,level:SearchContation.level,level2:SearchContation.level2});\r\n            }\r\n        }\r\n    }\r\n    handleBack = () => {\r\n        const { history } = this.props;\r\n        history.goBack();\r\n    }\r\n    //Direction Right Down Left\r\n    Codes = [\"FirstCode\", \"SecondCode\", \"ThirdCode\", \"FourthCode\", \"FifthCode\"];\r\n    CodesName = [\"FirstName\", \"SecondName\", \"ThirdName\", \"FourthName\", \"FifthName\"];\r\n    Arr = [];\r\n    expandRowKeys2 = [];\r\n    deepTree(data, index, pre) {\r\n        if (index >= data.length) {\r\n            return;\r\n        }\r\n        let Current = data[index];\r\n        let keyIndex = 0;\r\n        //var preNode = {};\r\n        var nowNode = {};\r\n        var CurrentNode = {};\r\n        var flg = false;//后面是否都是新插入 \r\n        let key;\r\n        let NameKey;\r\n        //let tempNode = {\"Code\":Current[key],\"Num\":Current[\"Num\"+keyIndex],\"children\":childrenNode};\r\n        //处理第一次空的插入\r\n        if (pre === {}) {\r\n            for (; keyIndex < this.Codes.length; keyIndex++) {\r\n                key = this.Codes[keyIndex];\r\n                NameKey = this.CodesName[keyIndex];\r\n                //\r\n\r\n                let tempNode = { Code: Current[key], Code2: (keyIndex + 1) + \"层物料编码:\" + Current[key], Num: Current[\"Num\" + (keyIndex + 1)], Name: Current[NameKey], children: [] };\r\n                if (keyIndex === 0) {\r\n                    pre = tempNode;\r\n                    nowNode = tempNode;\r\n                    this.Arr.push(nowNode);\r\n                    this.expandRowKeys2.push(nowNode.Code);\r\n                } else {\r\n                    nowNode.children.push(tempNode);\r\n                    nowNode = tempNode;\r\n                }\r\n            }\r\n            keyIndex = 0;\r\n            index += 1;\r\n            Current = data[index];\r\n        }\r\n        //判断是否要新插入\r\n        key = this.Codes[0];\r\n        NameKey = this.CodesName[0];\r\n        if (Current[key] !== pre[\"Code\"]) {//新插入\r\n            let tempNode = { \"Code\": Current[key], Code2: (1) + \"层物料编码:\" + Current[key], \"Num\": Current[\"Num\" + 1], Name: Current[NameKey], \"children\": [] };\r\n            CurrentNode = tempNode;\r\n            this.Arr.push(CurrentNode);\r\n            this.expandRowKeys2.push(CurrentNode.Code);\r\n            flg = true;\r\n        }\r\n        if (flg) {//全是新插入\r\n            for (keyIndex = 1; keyIndex < this.Codes.length; keyIndex++) {\r\n                key = this.Codes[keyIndex];\r\n                NameKey = this.CodesName[keyIndex];\r\n                if (Current[key] !== \"\") {\r\n                    let tempNode = { \"Code\": Current[key], Code2: (keyIndex + 1) + \"层物料编码:\" + Current[key], \"Num\": Current[\"Num\" + (keyIndex + 1)], Name: Current[NameKey], \"children\": [] };\r\n                    CurrentNode.children.push(tempNode);\r\n                    this.expandRowKeys2.push(tempNode.Code);\r\n                    CurrentNode = tempNode;\r\n                }\r\n\r\n            }\r\n        } else {//不是全部都是全新插入 \r\n            //寻找第一个Code不同的点\r\n            for (keyIndex = 1; keyIndex < this.Codes.length; keyIndex++) {\r\n                //undefined\r\n                key = this.Codes[keyIndex];\r\n                NameKey = this.CodesName[keyIndex];\r\n                if (Current[key] === \"\") {\r\n                    break;\r\n                }\r\n                if (flg) {//后面全是新插入\r\n                    if (Current[key] === \"\") {\r\n                        break;\r\n                    }\r\n                    let tempNode = { \"Code\": Current[key], Code2: (keyIndex + 1) + \"层物料编码:\" + Current[key], \"Num\": Current[\"Num\" + (keyIndex + 1)], Name: Current[NameKey], \"children\": [] };\r\n                    this.expandRowKeys2.push(tempNode.Code);\r\n                    pre.children.push(tempNode);\r\n                    pre = tempNode;\r\n                    continue;\r\n                }\r\n                let tempNode = pre.children.find(item => {\r\n                    if (item[\"Code\"] === \"\") {\r\n                        return false;\r\n                    }\r\n                    if (Current[key] === item[\"Code\"]) {\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                })\r\n                if (tempNode === undefined) {//需要新插入\r\n                    if (Current[key] === \"\") {\r\n                        break;\r\n                    }\r\n\r\n                    tempNode = { Code: Current[key], Code2: (keyIndex + 1) + \"层物料编码:\" + Current[key], \"Num\": Current[\"Num\" + (keyIndex + 1)], Name: Current[NameKey], \"children\": [] };\r\n                    this.expandRowKeys2.push(tempNode.Code);\r\n                    pre.children.push(tempNode);\r\n                    pre = tempNode;\r\n                    flg = true;\r\n                } else {//不需要新插入\r\n                    pre = tempNode;\r\n                }\r\n            }\r\n        }\r\n        this.deepTree(data, index + 1, this.Arr[this.Arr.length - 1]);\r\n    }\r\n\r\n    OpenOrCloseSingle = (record, type) => {\r\n        let { expandRowKeys } = this.state;\r\n        if (type) {\r\n            expandRowKeys.push(record.Code);\r\n        } else {\r\n            expandRowKeys = expandRowKeys.filter(item => {\r\n                if (item === record.Code) {\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n            })\r\n        }\r\n        this.setState({ expandRowKeys });\r\n    }\r\n    ExpandRow = (type) => {\r\n        const { dataSource } = this.state;\r\n        let expandRowKeys = [];\r\n        for (let i = 0; i < type; i++) {\r\n            if (i === 0) {\r\n                expandRowKeys = [];\r\n            }\r\n            if (i === 1) {\r\n                let tempKeys = dataSource.map(item => item.Code)\r\n                expandRowKeys = [...expandRowKeys, ...tempKeys]\r\n            }\r\n            if (i === 2) {\r\n                let tempKeys = [];\r\n                dataSource.forEach(item => {\r\n                    item.children.forEach(item2 => {\r\n                        tempKeys.push(item2.Code);\r\n                    })\r\n                })\r\n                expandRowKeys = [...expandRowKeys, ...tempKeys]\r\n            }\r\n            if (i === 3) {\r\n                let tempKeys = [];\r\n                dataSource.forEach(item => {\r\n                    item.children.forEach(item2 => {\r\n                        item2.children.forEach(item3 => tempKeys.push(item3.Code))\r\n                    })\r\n                })\r\n                expandRowKeys = [...expandRowKeys, ...tempKeys]\r\n            }\r\n            if (i === 3) {\r\n                let tempKeys = [];\r\n                dataSource.forEach(item => {\r\n                    item.children.forEach(item2 => {\r\n                        item2.children.forEach(item3 => {\r\n                            item3.children.forEach(item4 => tempKeys.push(item4.Code))\r\n                        })\r\n                    })\r\n                })\r\n                expandRowKeys = [...expandRowKeys, ...tempKeys]\r\n            }\r\n        }\r\n        this.setState({ expandRowKeys })\r\n    }\r\n    ExcelOut = async ()=>{\r\n        const {SearchContation} = this.state;\r\n        const ColumsWch = [\r\n            {wch:10},\r\n            {wch:20},\r\n            {wch:45},\r\n            {wch:20},\r\n            {wch:45},\r\n            {wch:20},\r\n            {wch:45},\r\n            {wch:20},\r\n            {wch:45},\r\n            {wch:20},\r\n            {wch:45},\r\n            {wch:10},\r\n          ]\r\n        this.setState({SpinTip:'Excel导出中，请等待',ExcelLoading:true});\r\n        SearchContation.page = 1;\r\n        SearchContation.pageSize = 999999;\r\n        const formData = ConvertFomrData(SearchContation);\r\n        //\r\n        const result = await getV_BjInfo(formData);\r\n        if(result.status===0){\r\n            const {V_BjInfo} = result.data;\r\n            V_BjInfo.forEach(item=>{\r\n                item.Datetime1 = moment(item.Datetime1).format(\"YYYYMMDD\");\r\n            })\r\n            downloadExcel(V_BjInfo,V_BjInfo_columns,ColumsWch,\"钣金需求单\");\r\n            this.setState({SpinTip:'Excel导出中，请等待',ExcelLoading:false});\r\n        }\r\n    }\r\n    componentDidMount = async () => {\r\n        this.handleTableChange();\r\n    }\r\n    render() {\r\n        const { dataSource, loading, expandRowKeys ,SearchContation,current,dataTotal,SpinTip,ExcelLoading,LTOrders,level,level2} = this.state;\r\n        let dt = this.expandRowKeys;\r\n        return (\r\n            <div className=\"main\">\r\n                <div style={{margin:'10px',float:\"left\",width:'80%'}}>\r\n                    <Form layout=\"inline\" ref={this.formRef}>\r\n                        <Form.Item>\r\n                            <LinkButton onClick={() => this.handleBack()}>\r\n                                <ArrowLeftOutlined />返回调度单\r\n                            </LinkButton>\r\n                        </Form.Item>\r\n                        <Form.Item\r\n                            label=\"系列\"\r\n                            name=\"Series\"\r\n                            style={{width:'160px'}}\r\n                        >\r\n                            <Input placeholder=\"默认所有系列\"></Input>\r\n                        </Form.Item>\r\n                        <Form.Item>\r\n                            <Button type=\"primary\" onClick={()=>this.handleTableChange({},{},{},1)}>查询</Button>\r\n                        </Form.Item>\r\n                        <Form.Item>\r\n                            <Button onClick={() => { this.ExpandRow(1) }}>查看第一层</Button>\r\n                            &ensp;\r\n                            <Button onClick={() => { this.ExpandRow(2) }}>查看第二层</Button>\r\n                            &ensp;\r\n                            <Button onClick={() => { this.ExpandRow(3) }}>查看第三层</Button>\r\n                            &ensp;\r\n                            <Button onClick={() => { this.ExpandRow(4) }}>查看第四层</Button>\r\n                            &ensp;\r\n                            <Button onClick={() => { this.ExpandRow(5) }}>查看第五层</Button>\r\n                        </Form.Item>\r\n                    </Form>\r\n                </div>\r\n                <div style={{float:'left',textAlign:'right',width:'16%'}}>\r\n                    <Button type=\"primary\" onClick={()=>this.ExcelOut()}>导出Excel</Button>\r\n                </div>\r\n                <div style={{float:\"left\",width:\"100%\"}}>\r\n                    <h2 style={{float:\"left\"}}>调度单:{LTOrders}</h2>\r\n                    {\r\n                    SearchContation.FirstCode===\"\"||SearchContation.FirstCode===undefined?\"\":\r\n                        <h2 style={{float:\"left\"}}>物料编码:{level===null||level===undefined?'1':level}层,{SearchContation.FirstCode}</h2>\r\n                    }\r\n                    {\r\n                        SearchContation.FirstName===\"\"||SearchContation.FirstName===undefined?\"\":\r\n                        <h2 style={{float:\"left\"}}>物料名称:{level2===null||level2===undefined?'1':level}层,{SearchContation.FirstName}</h2>\r\n                    }\r\n                </div>\r\n                <Table\r\n                    dataSource={dataSource}\r\n                    bordered\r\n                    rowKey=\"Code\"\r\n                    sticky={true}\r\n                    scroll={{ y: 600 }}\r\n                    size=\"small\"\r\n                    columns={DdOrder_BjInfo_First(this)}\r\n                    loading={loading}\r\n                    indentSize={15}\r\n                    onRow={record => {\r\n                        return {\r\n                            onMouseEnter: event => { },\r\n                            onMouseLeave: event => { }\r\n                        }\r\n                    }}\r\n                    expandable={{\r\n                        expandedRowKeys: expandRowKeys,\r\n                        onExpand: (expanded, record) => { this.OpenOrCloseSingle(record, expanded) }\r\n                    }}\r\n                    pagination={{\r\n                        position: ['bottomCenter'],\r\n                        pageSizeOptions:[10],\r\n                        current:current,\r\n                        total:dataTotal,\r\n                        showTotal:(total, range) => `一共 ${total} 条数据`,\r\n                        pageSize:10,\r\n                        onChange:(page,pageSize)=>{\r\n                            let start = (page-1)*pageSize;\r\n                            let end = (page)*pageSize;\r\n                            if(this.Arr.length!==0){\r\n                                if(end>this.Arr.length){\r\n                                    end = this.Arr.length;\r\n                                }\r\n                                let tempArr = this.Arr.slice(start,end-1);\r\n                                this.setState({dataSource:tempArr,current:page});\r\n                            }\r\n                            //this.Arr\r\n                            //this.handleTableChange({page:page,pageSize:pageSize});\r\n                        }\r\n                    }}\r\n                // expandable={{\r\n                //     expandRowByClick: true,\r\n                //     expandedRowRender,\r\n                //     columnWidth: 3,\r\n                //     indentSize: 0,\r\n                //     expandedRowKeys: expandRowKeys1,\r\n                //     onExpand: (expanded, record) => { this.OpenOrCloseSingle(record, expanded) }\r\n                // }}\r\n                >\r\n\r\n                </Table>\r\n                <Spin style={{ position: 'absolute', left: '48%', top: '47%' }} tip={SpinTip} spinning={ExcelLoading}></Spin>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n",{"ruleId":"177","replacedBy":"178"},{"ruleId":"179","replacedBy":"180"},{"ruleId":"181","severity":1,"message":"182","line":2,"column":28,"nodeType":"183","messageId":"184","endLine":2,"endColumn":34},{"ruleId":"177","replacedBy":"185"},{"ruleId":"179","replacedBy":"186"},{"ruleId":"187","severity":1,"message":"188","line":191,"column":33,"nodeType":"183","messageId":"189","endLine":191,"endColumn":35},{"ruleId":"190","severity":1,"message":"191","line":39,"column":13,"nodeType":"192","messageId":"193","endLine":39,"endColumn":21},{"ruleId":"190","severity":1,"message":"194","line":45,"column":13,"nodeType":"192","messageId":"193","endLine":45,"endColumn":25},{"ruleId":"195","severity":1,"message":"196","line":218,"column":50,"nodeType":"197","messageId":"198","endLine":227,"endColumn":18},{"ruleId":"181","severity":1,"message":"199","line":340,"column":13,"nodeType":"183","messageId":"184","endLine":340,"endColumn":15},"no-native-reassign",["200"],"no-negated-in-lhs",["201"],"no-unused-vars","'Select' is defined but never used.","Identifier","unusedVar",["200"],["201"],"no-redeclare","'dt' is already defined.","redeclared","no-dupe-keys","Duplicate key 'LTOrders'.","ObjectExpression","unexpected","Duplicate key 'ExcelLoading'.","no-loop-func","Function declared in a loop contains unsafe references to variable(s) 'key'.","ArrowFunctionExpression","unsafeRefs","'dt' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]